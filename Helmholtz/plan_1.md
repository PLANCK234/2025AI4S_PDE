# 混合学习与数值方法解决二维高频 Helmholtz 方程的系统方案

## 引言

二维 Helmholtz 方程
\[
 -\Delta u(x,y) - k^2 u(x,y) = q(x,y),\quad (x,y)\in \Omega,\qquad u|_{\partial\Omega}=0
\]
描述了以波数 \(k\) 传播的声波、电磁波等。随着 \(k\) 增大，解呈现高频振荡、波长缩短，数值求解面临严重的“污染效应”和规模灾难。传统有限元/差分法需要每波长 30–60 个网格点，导致离散矩阵巨大且强烈不定【25646317835666†L57-L60】。因此需要既能捕捉高频波动、又能兼顾效率的混合式求解框架。

本报告系统梳理最新的基于深度学习与数值分析的高频 Helmholtz 求解方法，并提出针对二维正问题的组合方案。文献表明：

* **Neumann Series Neural Operator (NSNO/UNO)** 通过将解写成 Neumann 级数并在网络中嵌入 U‑Net 多尺度结构，相比 Fourier Neural Operator (FNO) 在高波数下能减少至少 60 % 的相对误差并降低 50 % 计算成本【150555381245026†L103-L108】；
* **FNO** 利用 Fourier 变换在函数空间中学习算子，具有分辨率不依赖性和解算器级速度，可在多个网格上泛化【160317449477093†L9-L14】【160317449477093†L34-L44】；
* **平面波激活网络 (PWNN)** 使用复指数 \(e^{i\mathbf{x}\cdot\xi}\) 作为激活函数来匹配 Helmholtz 解的平面波结构，在多种网络和样本规模下优于标准激活和 SIREN，并能够学习未知方向的平面波基【163790799934506†L54-L70】；
* **物理约束神经算子 (PICNO)** 在卷积神经算子训练中引入 PDE 残差和边界条件作为损失，使得网络不仅拟合数据而且捕捉底层物理规律，在高频波场下显著优于纯数据驱动的 CNO【609033092637284†L52-L61】；
* **学习基数值方法 (LbNM)** 使用 Tikhonov 正则结合基本解稳定地学习 Helmholtz 方程的解算子，并可快速利用新的边界条件更新解【1817497044664†L58-L67】。

## 高频 Helmholtz 问题的挑战

1. **强振荡与污染效应**：波长 \(\lambda\sim 1/k\) 随 \(k\) 增大而缩短，离散化需极细网格。任何相位误差都会在传播中累积，导致数值解崩溃。
2. **线性系统病态**：离散后的矩阵既稀疏又高度不定，标准迭代法收敛极慢，且条件数随着 \(k\) 增加迅速变坏【25646317835666†L57-L60】。
3. **边界与介质复杂性**：高波数时人工边界（如 PML）需足够厚以吸收波动，异质介质和复杂几何增加了求解难度。

## 先进求解方法综述

### 1. 基于算子学习的方法

**FNO** 将积分核表示为 Fourier 模式，并在低频谱上学习线性映射，再通过逆变换输出解。它可在一个网格上训练，在另一网格上推断，解决了传统卷积神经网络分辨率耦合的问题【160317449477093†L34-L44】。FNO 的复杂度近似 \(\mathcal{O}(n\log n)\)，训练一次后推断速度可比传统求解器快数百到上千倍【160317449477093†L9-L14】。

**NSNO/UNO** 将解表示为 Neumann 级数项之和，并将 U‑Net 嵌入 Fourier 层以捕获多尺度特征。实验证明 NSNO 在大波数情况下较 FNO 至少降低 60 % 的相对 \(L^2\)-误差，并减少 50 % 计算成本与数据需求【150555381245026†L103-L108】。

**PICNO** 在神经算子训练中引入离散 PDE 残差和边界损失，使网络不仅拟合训练数据，还“学会”PDE 约束，对高频波场具有更好泛化能力【609033092637284†L52-L61】。

### 2. 单方程网络与特征工程

**平面波激活网络 (PWNN)** 利用 \(e^{i\mathbf{k}\cdot x}\) 作为激活函数，能够在网络内部产生近似解的平面波基，实现与平面波分片方法类似的效果。论文指出 PWNN 在不同架构和训练样本数量下都显著优于传统激活函数和 SIREN，并且在未知方向的平面波场中仍能保持较低误差【163790799934506†L54-L70】。

**液体神经网络 (LNN‑PINN)** 将液体神经元（随时间连续演化的动态门控）引入 PINN，在不改变采样与损失结构的情况下提升了四个基准 PDE 问题的训练精度和稳定性【506300797485580†L48-L67】（这里引用自前述研究）。

### 3. 预条件与数值增强

由于 Helmholtz 方程离散矩阵高度不定，Krylov 子空间法如 GMRES 收敛缓慢。**复杂移位 Laplace 预条件器** 通过引入复平移 \(k^2 \rightarrow k^2 + i\beta\) 来改变矩阵谱，从而加速外层迭代；预条件器系统可用多重网格或局部迭代近似求解【25646317835666†L104-L137】。这种方法使迭代法在高波数情况下也能获得 wavenumber‑independent 收敛。

### 4. 基于基本解与正则的学习

**Learning‑based Numerical Method (LbNM)** 提出使用 Helmholtz 方程的基本解（例如 Hankel 函数）组合构造解算子，并采用 Tikhonov 正则化稳定参数学习。这种方法利用相干信息（尤其是基本解）来保证算子的可解释性和可推广性，且可在新的边界输入下快速更新解【1817497044664†L58-L67】。

## 系统方案：融合算子学习与数值方法

综合上述方法，本方案旨在解决二维方域 \([-1,1]^2\) 上的高频 Helmholtz 正问题，具有以下步骤：

1. **神经算子主干**：选用 NSNO/UNO 作为基础算子学习框架。它学习从源项 \(q\) 和波数 \(k\) 到解 \(u\) 的映射，并在训练时采用多尺度 U‑Net 结构和 Fourier 层，以获得高频特征的表达能力【150555381245026†L103-L108】。
2. **平面波与 Hankel 特征嵌入**：在网络输入中附加平面波激活支路，使模型能够自动学习传播方向；对于近场点源问题，可加入 Hankel 函数卷积层以利用基本解信息【163790799934506†L54-L70】。这两种特征工程降低了网络表示高频解的难度。
3. **物理约束损失**：采用 PICNO/PINO 的思想，将离散化的 PDE 残差及边界条件加入网络损失项，指导网络在低数据量时仍能满足物理规律【609033092637284†L52-L61】。对未知介质或多参数任务，可额外增加正则化项限制网络参数范数 (Tikhonov)【1817497044664†L58-L67】。
4. **训练数据设计**：
   - **制造解与随机特征**：利用拉普拉斯算子的特征函数随机组合生成候选解，再通过计算 \(-\Delta u - k^2u\) 得到对应源项，从而无需传统求解器即可快速生成大量训练样本【990917945013292†L126-L135】。针对 Dirichlet 边界，特征函数可取 \(\sin(m\pi x)\sin(n\pi y)\)。
   - **高精解校正**：为确保高频精度，可在少数参数组合上使用高阶有限元求解器生成基准解用于监督微调。
   - **课程式波数采样**：先在较小波数上训练，再逐步增大 \(k\) ；参数 \(k\) 、源项形状和介质取值均需覆盖泛化范围。
5. **预条件迭代细化**：训练好的神经算子输出初始解后，进行少量 GMRES 迭代，以复杂移位 Laplace 预条件器作为内层求解器来消除剩余误差。通常 1–3 步迭代即可将相对误差降至数值精度【25646317835666†L104-L137】。

## 训练与推断流程

### 数据采样

1. **内部配点**：在域内使用 Sobol 或拉丁超立方采样大量点，用于计算物理损失；残差驱动自适应加密可在震荡剧烈区域补充采样点。
2. **边界配点**：均匀采样边界，并赋零 Dirichlet 条件。边界点占比可设为 20–30 %。
3. **参数采样**：训练集覆盖 \(k\) 范围及不同源项；对介质随机场可采用 KL 展开系数作为输入。

### 网络训练

1. **无监督阶段**：仅使用 PDE 残差和边界损失训练 NSNO/UNO；采用自适应权重平衡损失项。
2. **半监督精调**：在无监督基础上，加入少量高精度样本的监督误差帮助收敛。
3. **正则化与稳定**：引入 Tikhonov 正则化，约束模型参数；在训练过程中监控 PDE 残差和能量守恒。

### 推断及精修

1. 对新的源项和波数，使用训练好的神经算子直接输出初始解，计算成本近似 \(\mathcal{O}(n\log n)\)。
2. 对于误差敏感的高波数情况，通过 1–3 步 GMRES 迭代（移位 Laplace 预条件器）进一步降低误差，确保精度和收敛性。

## 结论

面对二维高频 Helmholtz 方程的求解难题，单一方法往往无法兼顾效率和精度。本报告提出的系统方案将 **NSNO/UNO** 的高效算子学习、**平面波激活与 Hankel 基** 的特征嵌入、**PICNO** 的物理约束损失、**Tikhonov 正则化** 与 **预条件迭代精修** 融合起来，形成一个兼顾训练速度、泛化能力与物理解一致性的混合框架。通过合理的训练数据生成和参数采样，模型可在宽范围波数和源项下快速求解高频 Helmholtz 方程并保持高精度，对于正向求解和逆散射问题均具有潜在价值。
